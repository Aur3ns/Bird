- Pour le jeton d'enrollement:
docker-compose exec elasticsearch \
  /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana

- Résultat:
>   /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
WARN[0000] /workspaces/Bird/omnisec-proto/infra/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
WARNING: Owner of file [/usr/share/elasticsearch/config/users] used to be [root], but now is [elasticsearch]
WARNING: Owner of file [/usr/share/elasticsearch/config/users_roles] used to be [root], but now is [elasticsearch]
eyJ2ZXIiOiI4LjUuMSIsImFkciI6WyIxNzIuMTguMC4zOjkyMDAiXSwiZmdyIjoiZDE5YjcxYWEwNjAwNzZkYmZiNzczZTg5YTIyMTYzZWUwMjMyM2VmMjRhZGU0M2Q5ODM3Mjk5MmYyNTM3YmQxNSIsImtleSI6Ik81bENWSllCazZDM3M2WkFrYkNtOnQzeUR1MXBWUjcyUWs4Q0FZTFNjeFEifQ==

===================================================================================================================================================================================================================================================================

- Commande pour récupérer le code pour la vérification:
docker-compose exec kibana \
  bin/kibana-verification-code

- Résultat:
>   bin/kibana-verification-code
WARN[0000] /workspaces/Bird/omnisec-proto/infra/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
Your verification code is:  315 841 

===================================================================================================================================================================================================================================================================

- Commande pour le service account token pour le compte système kibana_system:

docker-compose exec elasticsearch \
  /usr/share/elasticsearch/bin/elasticsearch-service-tokens create elastic/kibana kibana-token

- Résultat:
>   /usr/share/elasticsearch/bin/elasticsearch-service-tokens create elastic/kibana kibana-token
SERVICE_TOKEN elastic/kibana/kibana-token = AAEAAWVsYXN0aWMva2liYW5hL2tpYmFuYS10b2tlbjo0SVMwd0xXd1FUNl9sZFBkUHBPTXVB

===================================================================================================================================================================================================================================================================



Commande pour tout rebuild sans devoir tout redémarrer :

  kafka:
    image: confluentinc/cp-kafka:latest
    depends_on:
      - zookeeper
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: 'zookeeper:2181'
      # 1) Listeners internes et externes sur deux ports distincts
      KAFKA_LISTENERS: PLAINTEXT://0.0.0.0:9092,PLAINTEXT_HOST://0.0.0.0:29092
      # 2) Comment Docker et ton agent résolvent ces deux listeners
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092,PLAINTEXT_HOST://localhost:29092
      # 3) Mapping des protocoles
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
    ports:
      - "9092:9092"     # pour les containers Docker
      - "29092:29092"   # pour ta machine hôte / Codespace
